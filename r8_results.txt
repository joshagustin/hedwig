python -m models.reg_lstm --dataset R8 --mode static --batch-size 32 --lr 0.01 --epochs 30 --bidirectional --num-layers 1 --hidden-dim 512 --wdrop 0.1 --embed-droprate 0.2 --dropout 0.5 --beta-ema 0.99 --seed 3435 --no-cuda
Dataset: R8
No. of target classes: 8
No. of train instances 4937
No. of dev instances 2189
No. of test instances 2189
Applying weight drop of 0.1 to weight_hh_l0

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
     2     1         1     1/155         1% 2.069596       3.1250
    72     1        11    11/155         7% 2.227703      36.6477
   112     1        21    21/155        14% 3.381757      52.0833
   175     1        31    31/155        20% 1.554556      47.4798
   213     1        41    41/155        26% 1.030617      48.3232
   256     1        51    51/155        33% 1.094667      50.1225
   300     1        61    61/155        39% 1.921577      51.4857
   360     1        71    71/155        46% 0.782201      52.6849
   395     1        81    81/155        52% 1.412387      55.2083
   418     1        91    91/155        59% 0.299087      58.2074
   450     1       101   101/155        65% 0.453966      59.7463
   490     1       111   111/155        72% 0.251926      61.3739
   539     1       121   121/155        78% 1.950163      62.6808
   601     1       131   131/155        85% 1.529713      63.2634
   720     1       141   141/155        91% 0.277029      63.8672
   755     1       151   151/155        97% 1.468831      64.8991

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  1149     1       155     1/30     0.7707   0.7707   0.7707       0.7707       0.6755

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  1240     2       161     6/155         4% 0.416888      84.8958
  1401     2       171    16/155        10% 1.024578      82.0312
  1565     2       181    26/155        17% 0.259456      82.0913
  1940     2       191    36/155        23% 0.668043      80.3819
  2094     2       201    46/155        30% 0.613607      81.7255
  2262     2       211    56/155        36% 0.709679      81.3058
  2588     2       221    66/155        43% 0.167499      80.1610
  2766     2       231    76/155        49% 0.149413      81.0033
  3100     2       241    86/155        55% 0.799370      80.7413
  3261     2       251    96/155        62% 0.346013      81.1523
  3403     2       261   106/155        68% 0.622768      81.6627
  3627     2       271   116/155        75% 0.071224      82.1390
  4028     2       281   126/155        81% 0.876442      81.8452
  4139     2       291   136/155        88% 0.187074      82.2840
  4371     2       301   146/155        94% 0.260091      82.4048

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  5166     2       310     2/30     0.8945   0.8945   0.8945       0.8945       0.2999

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  5172     3       311     1/155         1% 0.684752      78.1250
  5333     3       321    11/155         7% 0.904530      86.0795
  5523     3       331    21/155        14% 0.284601      87.9464
  5700     3       341    31/155        20% 0.407027      89.3145
  5968     3       351    41/155        26% 0.432069      89.2530
  6268     3       361    51/155        33% 0.173290      89.3995
  6438     3       371    61/155        39% 0.430656      89.6516
  6710     3       381    71/155        46% 0.127351      89.5246
  6883     3       391    81/155        52% 0.480295      89.1975
  7067     3       401    91/155        59% 0.445910      88.9423
  7346     3       411   101/155        65% 0.651882      88.9233
  7503     3       421   111/155        72% 0.063185      89.0203
  7682     3       431   121/155        78% 0.595273      89.2045
  7749     3       441   131/155        85% 0.312929      89.2300
  7812     3       451   141/155        91% 0.764416      88.9730
  7847     3       461   151/155        97% 0.181779      89.1454

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  7932     3       465     3/30     0.9525   0.9525   0.9525       0.9525       0.1600

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  7960     4       471     6/155         4% 0.657624      88.5417
  8025     4       481    16/155        10% 0.526475      89.4531
  8059     4       491    26/155        17% 0.085645      90.6250
  8092     4       501    36/155        23% 0.250900      90.7118
  8128     4       511    46/155        30% 0.003348      90.7609
  8158     4       521    56/155        36% 0.059963      90.7924
  8185     4       531    66/155        43% 0.002271      90.8617
  8209     4       541    76/155        49% 0.403461      90.8306
  8261     4       551    86/155        55% 0.237337      90.6977
  8293     4       561    96/155        62% 0.065512      91.0807
  8353     4       571   106/155        68% 0.573111      90.6250
  8385     4       581   116/155        75% 0.224546      90.7597
  8445     4       591   126/155        81% 0.529319      90.8456
  8487     4       601   136/155        88% 0.074904      91.0834
  8533     4       611   146/155        94% 0.196800      91.1809

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  8633     4       620     4/30     0.9561   0.9561   0.9561       0.9561       0.1220

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  8638     5       621     1/155         1% 0.334389      84.3750
  8682     5       631    11/155         7% 0.051932      94.6023
  8718     5       641    21/155        14% 0.453454      92.5595
  8774     5       651    31/155        20% 0.057812      91.7339
  8800     5       661    41/155        26% 0.025822      92.8354
  8820     5       671    51/155        33% 0.011762      93.1985
  8857     5       681    61/155        39% 0.056024      93.4426
  8891     5       691    71/155        46% 0.303163      93.6620
  8978     5       701    81/155        52% 0.438791      93.0556
  9008     5       711    91/155        59% 0.004734      93.1662
  9032     5       721   101/155        65% 0.208442      93.2859
  9081     5       731   111/155        72% 0.222350      93.2714
  9144     5       741   121/155        78% 0.231670      93.1151
  9196     5       751   131/155        85% 0.069258      93.0439
  9219     5       761   141/155        91% 0.541085      93.0720
  9271     5       771   151/155        97% 0.000290      93.1587

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  9363     5       775     5/30     0.9644   0.9644   0.9644       0.9644       0.1065

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  9375     6       781     6/155         4% 0.141746      96.8750
  9444     6       791    16/155        10% 0.351436      94.1406
  9498     6       801    26/155        17% 0.480141      93.0288
  9547     6       811    36/155        23% 0.336963      93.4896
  9578     6       821    46/155        30% 0.100736      93.8859
  9606     6       831    56/155        36% 0.037581      93.6942
  9637     6       841    66/155        43% 0.228658      93.5133
  9661     6       851    76/155        49% 0.208832      93.6678
  9704     6       861    86/155        55% 0.424860      93.8227
  9732     6       871    96/155        62% 0.240697      93.8151
  9778     6       881   106/155        68% 0.000106      94.0448
  9843     6       891   116/155        75% 0.394191      94.1448
  9908     6       901   126/155        81% 0.040013      94.2130
  9940     6       911   136/155        88% 0.242583      94.0633
  9986     6       921   146/155        94% 0.000176      93.9557

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 10106     6       930     6/30     0.9689   0.9689   0.9689       0.9689       0.1005

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 10109     7       931     1/155         1% 0.076790      96.8750
 10179     7       941    11/155         7% 0.399271      91.7614
 10206     7       951    21/155        14% 0.037878      94.0476
 10243     7       961    31/155        20% 0.470624      93.0444
 10264     7       971    41/155        26% 0.281299      93.6738
 10318     7       981    51/155        33% 0.166925      93.6887
 10369     7       991    61/155        39% 0.254833      93.8012
 10396     7      1001    71/155        46% 0.002975      93.7500
 10440     7      1011    81/155        52% 0.039643      93.7886
 10467     7      1021    91/155        59% 0.529160      93.9217
 10504     7      1031   101/155        65% 0.291133      94.0594
 10562     7      1041   111/155        72% 0.243128      93.6655
 10593     7      1051   121/155        78% 0.026873      93.7242
 10679     7      1061   131/155        85% 0.023070      93.4996
 10725     7      1071   141/155        91% 0.307385      93.4061
 10761     7      1081   151/155        97% 0.062729      93.6369

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 10851     7      1085     7/30     0.9653   0.9653   0.9653       0.9653       0.1029

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 10868     8      1091     6/155         4% 0.064535      95.8333
 10905     8      1101    16/155        10% 0.014563      95.7031
 10957     8      1111    26/155        17% 0.106936      94.8317
 10986     8      1121    36/155        23% 0.052823      94.7049
 11018     8      1131    46/155        30% 0.259961      94.2935
 11089     8      1141    56/155        36% 0.002675      94.5871
 11115     8      1151    66/155        43% 0.000079      94.6496
 11172     8      1161    76/155        49% 0.048305      94.4901
 11212     8      1171    86/155        55% 0.125540      94.1134
 11258     8      1181    96/155        62% 0.167905      94.0755
 11289     8      1191   106/155        68% 0.287764      94.1038
 11315     8      1201   116/155        75% 0.256173      94.0463
 11344     8      1211   126/155        81% 0.000276      93.9732
 11435     8      1221   136/155        88% 0.443826      93.8092
 11471     8      1231   146/155        94% 0.132304      93.7621

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 11592     8      1240     8/30     0.9635   0.9635   0.9635       0.9635       0.1054

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 11595     9      1241     1/155         1% 0.051130     100.0000
 11642     9      1251    11/155         7% 0.431594      94.6023
 11673     9      1261    21/155        14% 0.021799      94.6429
 11702     9      1271    31/155        20% 0.380170      93.3468
 11732     9      1281    41/155        26% 1.118790      93.8262
 11765     9      1291    51/155        33% 0.132748      93.6275
 11791     9      1301    61/155        39% 0.004046      94.2111
 11857     9      1311    71/155        46% 0.293650      93.9701
 11890     9      1321    81/155        52% 0.515310      94.0586
 11936     9      1331    91/155        59% 0.002143      93.8530
 11986     9      1341   101/155        65% 0.000051      93.8428
 12023     9      1351   111/155        72% 0.059739      94.0034
 12094     9      1361   121/155        78% 0.704021      93.9465
 12125     9      1371   131/155        85% 0.051309      94.0034
 12183     9      1381   141/155        91% 0.283919      93.8962
 12220     9      1391   151/155        97% 0.170968      93.5330

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 12305     9      1395     9/30     0.9667   0.9667   0.9667       0.9667       0.1007

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 12319    10      1401     6/155         4% 0.005323      96.3542
 12377    10      1411    16/155        10% 0.242371      91.2109
 12405    10      1421    26/155        17% 0.000071      92.4279
 12434    10      1431    36/155        23% 0.065026      93.0556
 12467    10      1441    46/155        30% 0.414986      93.5462
 12501    10      1451    56/155        36% 0.232512      93.8058
 12530    10      1461    66/155        43% 0.108779      94.3182
 12585    10      1471    76/155        49% 0.302448      94.2845
 12640    10      1481    86/155        55% 0.109653      94.1497
 12670    10      1491    96/155        62% 0.001693      94.2383
 12706    10      1501   106/155        68% 0.077377      94.4870
 12746    10      1511   116/155        75% 0.607203      94.1810
 12792    10      1521   126/155        81% 0.214327      94.1716
 12854    10      1531   136/155        88% 0.340490      94.2019
 12913    10      1541   146/155        94% 0.246732      94.1923

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 13022    10      1550    10/30     0.9621   0.9621   0.9621       0.9621       0.1072

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 13025    11      1551     1/155         1% 0.105452      96.8750
 13051    11      1561    11/155         7% 0.218323      95.4545
 13095    11      1571    21/155        14% 0.166658      94.4940
 13142    11      1581    31/155        20% 0.316589      94.5565
 13202    11      1591    41/155        26% 0.309270      93.5976
 13233    11      1601    51/155        33% 0.004055      94.0564
 13271    11      1611    61/155        39% 0.202685      93.9037
 13327    11      1621    71/155        46% 0.106541      94.1021
 13358    11      1631    81/155        52% 0.173010      94.3673
 13388    11      1641    91/155        59% 0.014715      94.4712
 13413    11      1651   101/155        65% 0.002226      94.4926
 13448    11      1661   111/155        72% 0.056125      94.5383
 13487    11      1671   121/155        78% 0.216684      94.5506
 13550    11      1681   131/155        85% 0.243423      94.2510
 13626    11      1691   141/155        91% 0.033130      94.0521
 13660    11      1701   151/155        97% 0.227319      94.0320

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 13740    11      1705    11/30     0.9694   0.9694   0.9694       0.9694       0.0957

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 13762    12      1711     6/155         4% 0.546655      94.7917
 13799    12      1721    16/155        10% 0.325434      95.3125
 13847    12      1731    26/155        17% 0.227290      94.8317
 13872    12      1741    36/155        23% 0.025294      94.8785
 13934    12      1751    46/155        30% 0.180535      94.4973
 13978    12      1761    56/155        36% 0.781177      94.6429
 14018    12      1771    66/155        43% 0.142244      94.7917
 14052    12      1781    76/155        49% 0.423531      94.9836
 14089    12      1791    86/155        55% 0.011315      95.0581
 14125    12      1801    96/155        62% 0.000003      95.1497
 14186    12      1811   106/155        68% 0.001026      94.9292
 14234    12      1821   116/155        75% 0.424943      94.8815
 14272    12      1831   126/155        81% 0.018669      94.8909
 14341    12      1841   136/155        88% 1.008490      94.6639
 14376    12      1851   146/155        94% 0.882108      94.6870

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 14486    12      1860    12/30     0.9694   0.9694   0.9694       0.9694       0.0985

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 14488    13      1861     1/155         1% 0.509603      81.2500
 14527    13      1871    11/155         7% 0.032793      94.0341
 14583    13      1881    21/155        14% 0.249287      94.3452
 14612    13      1891    31/155        20% 0.000969      95.4637
 14655    13      1901    41/155        26% 0.284277      95.8079
 14701    13      1911    51/155        33% 0.032441      95.8946
 14726    13      1921    61/155        39% 0.374101      95.7480
 14754    13      1931    71/155        46% 0.014256      95.8187
 14788    13      1941    81/155        52% 0.422199      95.7948
 14814    13      1951    91/155        59% 0.001077      95.9478
 14883    13      1961   101/155        65% 0.145942      95.8230
 14953    13      1971   111/155        72% 0.188122      95.7495
 15013    13      1981   121/155        78% 0.303484      95.5313
 15040    13      1991   131/155        85% 0.001184      95.5145
 15099    13      2001   141/155        91% 0.395053      95.5001
 15133    13      2011   151/155        97% 0.061783      95.2381

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 15224    13      2015    13/30     0.9630   0.9630   0.9630       0.9630       0.1084

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 15251    14      2021     6/155         4% 0.258533      93.2292
 15289    14      2031    16/155        10% 0.222618      94.7266
 15326    14      2041    26/155        17% 0.530596      93.7500
 15357    14      2051    36/155        23% 0.037718      93.4028
 15396    14      2061    46/155        30% 0.378085      93.9538
 15472    14      2071    56/155        36% 0.001231      94.0848
 15511    14      2081    66/155        43% 0.264275      94.3182
 15546    14      2091    76/155        49% 0.142609      94.2845
 15601    14      2101    86/155        55% 0.313191      94.4767
 15630    14      2111    96/155        62% 0.394304      94.4987
 15659    14      2121   106/155        68% 0.000000      94.5165
 15689    14      2131   116/155        75% 0.308281      94.5312
 15737    14      2141   126/155        81% 0.353566      94.5188
 15821    14      2151   136/155        88% 0.265028      94.5253
 15863    14      2161   146/155        94% 0.046027      94.7085

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 15963    14      2170    14/30     0.9635   0.9635   0.9635       0.9635       0.1208

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 15970    15      2171     1/155         1% 0.068337      96.8750
 16005    15      2181    11/155         7% 0.000002      96.8750
 16037    15      2191    21/155        14% 0.282679      95.3869
 16053    15      2201    31/155        20% 0.005979      96.5726
 16104    15      2211    41/155        26% 0.000068      96.2652
 16172    15      2221    51/155        33% 0.499738      95.6495
 16218    15      2231    61/155        39% 0.226161      95.4406
 16240    15      2241    71/155        46% 0.119599      95.5546
 16287    15      2251    81/155        52% 0.413699      95.5247
 16316    15      2261    91/155        59% 0.339958      95.1923
 16374    15      2271   101/155        65% 0.000385      95.3589
 16435    15      2281   111/155        72% 0.222082      95.1014
 16480    15      2291   121/155        78% 0.518073      94.9897
 16506    15      2301   131/155        85% 0.218921      95.2290
 16573    15      2311   141/155        91% 0.019858      95.2996
 16622    15      2321   151/155        97% 0.256428      95.3837

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 16712    15      2325    15/30     0.9621   0.9621   0.9621       0.9621       0.1226

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
 16725    16      2331     6/155         4% 0.000016      98.9583
 16740    16      2341    16/155        10% 0.000060      97.6562
 16778    16      2351    26/155        17% 0.002284      97.3558
 16841    16      2361    36/155        23% 0.230035      96.8750
 16883    16      2371    46/155        30% 0.257276      96.1957
 16918    16      2381    56/155        36% 0.086848      96.2612
 16982    16      2391    66/155        43% 0.075164      95.9754
 17010    16      2401    76/155        49% 0.129823      96.0115
 17068    16      2411    86/155        55% 0.390227      95.4578
 17114    16      2421    96/155        62% 0.091103      95.2474
 17139    16      2431   106/155        68% 0.027560      95.3420
 17192    16      2441   116/155        75% 0.135356      95.3125
 17250    16      2451   126/155        81% 0.009583      95.1858
 17289    16      2461   136/155        88% 0.092838      95.1490
 17322    16      2471   146/155        94% 0.286455      95.0957

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
 17437    16      2480    16/30     0.9667   0.9667   0.9667       0.9667       0.1145
Early Stopping. Epoch: 16, Best Dev F1: 0.9693924166285975
Evaluation metrics for dev
['accuracy', 'precision', 'recall', 'f1', 'cross_entropy_loss']
[0.9693924166285975, 0.9693924166285975, 0.9693924166285975, 0.9693924166285975, 0.0957463435682329]
Evaluation metrics for test
['accuracy', 'precision', 'recall', 'f1', 'cross_entropy_loss']
[0.9693924166285975, 0.9693924166285975, 0.9693924166285975, 0.9693924166285975, 0.0957463435682329]