python -m models.reg_lstm --dataset OHSUMED --mode static --batch-size 32 --lr 0.01 --epochs 30 --bidirectional --num-layers 1 --hidden-dim 512 --wdrop 0.1 --embed-droprate 0.2 --dropout 0.5 --beta-ema 0.99 --seed 3435 --no-cuda
Dataset: OHSUMED
No. of target classes: 23
No. of train instances 3021
No. of dev instances 4043
No. of test instances 4043
Applying weight drop of 0.1 to weight_hh_l0

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
     3     1         1     1/95          1% 3.139118       0.0000
    41     1        11    11/95         12% 2.519421      16.4773
    78     1        21    21/95         22% 2.762022      23.8897
   102     1        31    31/95         33% 2.271372      26.5159
   130     1        41    41/95         43% 2.440469      29.0797
   164     1        51    51/95         54% 2.488734      32.1761
   204     1        61    61/95         64% 1.964207      35.3337
   236     1        71    71/95         75% 2.077775      36.6178
   258     1        81    81/95         85% 1.799454      37.3883
   286     1        91    91/95         96% 1.595355      38.1611

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
   425     1        95     1/30     0.4831   0.4831   0.4831       0.4831       1.8636

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
   445     2       101     6/95          6% 1.283591      44.7917
   477     2       111    16/95         17% 1.468245      51.7578
   507     2       121    26/95         27% 1.752400      50.1202
   540     2       131    36/95         38% 1.167712      51.3021
   577     2       141    46/95         48% 1.921640      51.0190
   608     2       151    56/95         59% 1.582025      51.3393
   636     2       161    66/95         69% 1.412323      50.5682
   666     2       171    76/95         80% 1.794289      50.8496
   697     2       181    86/95         91% 1.554964      50.4574

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
   840     2       190     2/30     0.5719   0.5719   0.5719       0.5719       1.5392

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
   844     3       191     1/95          1% 1.496580      65.6250
   871     3       201    11/95         12% 1.158025      57.9580
   899     3       211    21/95         22% 1.274767      55.1302
   921     3       221    31/95         33% 1.541603      56.7318
   952     3       231    41/95         43% 1.144994      56.6899
   998     3       241    51/95         54% 1.586737      57.4706
  1029     3       251    61/95         64% 1.805571      57.1133
  1056     3       261    71/95         75% 1.071847      56.8575
  1089     3       271    81/95         85% 1.267759      57.2872
  1123     3       281    91/95         96% 1.305441      57.4490

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  1246     3       285     3/30     0.6090   0.6090   0.6090       0.6090       1.4011

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  1261     4       291     6/95          6% 1.361472      58.8542
  1294     4       301    16/95         17% 1.349118      62.1094
  1325     4       311    26/95         27% 1.456928      63.8221
  1347     4       321    36/95         38% 2.241234      61.3715
  1384     4       331    46/95         48% 1.361659      61.4810
  1411     4       341    56/95         59% 1.369818      60.4353
  1448     4       351    66/95         69% 1.169159      60.6534
  1475     4       361    76/95         80% 1.353587      59.9507
  1511     4       371    86/95         91% 1.185019      60.4098

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  1649     4       380     4/30     0.6297   0.6297   0.6297       0.6297       1.3119

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  1653     5       381     1/95          1% 1.416063      59.3750
  1679     5       391    11/95         12% 1.315544      61.3636
  1710     5       401    21/95         22% 0.765643      64.2857
  1739     5       411    31/95         33% 0.827972      66.3306
  1761     5       421    41/95         43% 0.995677      65.7774
  1797     5       431    51/95         54% 1.279237      65.9926
  1823     5       441    61/95         64% 0.966749      66.4959
  1860     5       451    71/95         75% 1.058290      66.2228
  1878     5       461    81/95         85% 0.949432      66.4205
  1893     5       471    91/95         96% 1.358924      65.7449

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  1949     5       475     5/30     0.6337   0.6337   0.6337       0.6337       1.2827

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  1960     6       481     6/95          6% 0.625841      77.0833
  1976     6       491    16/95         17% 0.824991      72.4609
  1991     6       501    26/95         27% 1.233305      71.0947
  2004     6       511    36/95         38% 1.107021      69.7264
  2021     6       521    46/95         48% 1.191444      69.0296
  2035     6       531    56/95         59% 1.108950      68.7535
  2051     6       541    66/95         69% 1.145334      69.0397
  2065     6       551    76/95         80% 1.357980      68.2553
  2079     6       561    86/95         91% 0.820387      68.4596

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  2141     6       570     6/30     0.6344   0.6344   0.6344       0.6344       1.2635

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  2141     7       571     1/95          1% 1.435309      59.3750
  2172     7       581    11/95         12% 0.955509      74.7159
  2192     7       591    21/95         22% 1.002558      74.7024
  2235     7       601    31/95         33% 0.361249      73.8952
  2273     7       611    41/95         43% 0.714712      72.7765
  2309     7       621    51/95         54% 0.959803      73.4036
  2338     7       631    61/95         64% 1.150490      72.4780
  2364     7       641    71/95         75% 1.032285      71.5934
  2398     7       651    81/95         85% 0.688097      71.5896
  2427     7       661    91/95         96% 0.747533      71.3446

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  2559     7       665     7/30     0.6384   0.6384   0.6384       0.6384       1.2479

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  2576     8       671     6/95          6% 0.902221      73.9583
  2604     8       681    16/95         17% 1.074903      74.0234
  2635     8       691    26/95         27% 0.830495      74.1587
  2665     8       701    36/95         38% 0.668298      73.8715
  2697     8       711    46/95         48% 0.398589      74.1168
  2729     8       721    56/95         59% 1.201478      74.5536
  2762     8       731    66/95         69% 1.064953      74.2424
  2796     8       741    76/95         80% 0.709906      74.4243
  2831     8       751    86/95         91% 0.930313      73.8749

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  2975     8       760     8/30     0.6431   0.6431   0.6431       0.6431       1.2459

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  2977     9       761     1/95          1% 0.931868      68.7500
  3007     9       771    11/95         12% 0.815702      75.8523
  3036     9       781    21/95         22% 0.846199      76.4165
  3066     9       791    31/95         33% 0.895675      77.3895
  3100     9       801    41/95         43% 0.768152      77.1075
  3131     9       811    51/95         54% 0.983302      77.1854
  3155     9       821    61/95         64% 0.771907      76.5649
  3189     9       831    71/95         75% 0.491623      76.0763
  3226     9       841    81/95         85% 0.664734      75.4372
  3259     9       851    91/95         96% 0.836003      75.4580

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  3385     9       855     9/30     0.6369   0.6369   0.6369       0.6369       1.2787

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  3408    10       861     6/95          6% 0.413987      80.7292
  3440    10       871    16/95         17% 0.608252      80.1217
  3473    10       881    26/95         27% 0.490291      79.8278
  3495    10       891    36/95         38% 0.841953      79.9647
  3524    10       901    46/95         48% 0.668826      79.2154
  3558    10       911    56/95         59% 0.440901      78.5674
  3584    10       921    66/95         69% 0.895404      78.3086
  3621    10       931    76/95         80% 0.857719      77.2482
  3656    10       941    86/95         91% 0.439979      77.1679

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  3785    10       950    10/30     0.6443   0.6443   0.6443       0.6443       1.2817

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  3787    11       951     1/95          1% 0.470018      84.3750
  3821    11       961    11/95         12% 0.734060      79.5455
  3852    11       971    21/95         22% 0.635815      81.3988
  3881    11       981    31/95         33% 0.827033      82.3589
  3911    11       991    41/95         43% 0.670056      81.0976
  3940    11      1001    51/95         54% 0.513705      79.9020
  3975    11      1011    61/95         64% 0.805939      80.1742
  4005    11      1021    71/95         75% 0.680243      80.0176
  4038    11      1031    81/95         85% 0.816479      79.6347
  4066    11      1041    91/95         96% 0.471820      79.6059

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  4188    11      1045    11/30     0.6367   0.6367   0.6367       0.6367       1.2940

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  4217    12      1051     6/95          6% 0.608415      85.4167
  4248    12      1061    16/95         17% 0.758749      85.3516
  4274    12      1071    26/95         27% 0.474439      84.0144
  4300    12      1081    36/95         38% 0.341113      83.2304
  4317    12      1091    46/95         48% 1.307113      82.1748
  4356    12      1101    56/95         59% 0.769413      81.6695
  4396    12      1111    66/95         69% 0.658172      82.0831
  4430    12      1121    76/95         80% 1.149035      81.5168
  4452    12      1131    86/95         91% 0.711670      81.0465

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  4584    12      1140    12/30     0.6389   0.6389   0.6389       0.6389       1.3128

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  4593    13      1141     1/95          1% 0.612560      78.1250
  4620    13      1151    11/95         12% 0.355579      84.0909
  4656    13      1161    21/95         22% 0.890266      85.4167
  4680    13      1171    31/95         33% 0.624432      85.0806
  4704    13      1181    41/95         43% 0.458353      83.7652
  4736    13      1191    51/95         54% 0.525076      83.0882
  4762    13      1201    61/95         64% 0.429758      82.4108
  4790    13      1211    71/95         75% 0.237868      82.2459
  4822    13      1221    81/95         85% 0.865708      82.4330
  4858    13      1231    91/95         96% 0.308898      82.5786

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  4987    13      1235    13/30     0.6369   0.6369   0.6369       0.6369       1.3093

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  5003    14      1241     6/95          6% 0.518471      89.5833
  5032    14      1251    16/95         17% 0.469305      87.6953
  5067    14      1261    26/95         27% 0.415343      87.1394
  5090    14      1271    36/95         38% 0.214075      86.6319
  5121    14      1281    46/95         48% 0.267263      86.2772
  5150    14      1291    56/95         59% 0.953448      85.3920
  5171    14      1301    66/95         69% 0.327315      84.5676
  5216    14      1311    76/95         80% 1.001159      83.8790
  5251    14      1321    86/95         91% 0.683844      83.4614

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  5381    14      1330    14/30     0.6414   0.6414   0.6414       0.6414       1.3306

  Time Epoch Iteration Progress    (%Epoch)   Loss     Accuracy
  5384    15      1331     1/95          1% 0.322262      90.6250
  5407    15      1341    11/95         12% 0.226221      85.7955
  5447    15      1351    21/95         22% 0.364022      84.6726
  5483    15      1361    31/95         33% 0.178565      85.5087
  5511    15      1371    41/95         43% 0.347666      85.1508
  5534    15      1381    51/95         54% 0.915703      84.8109
  5566    15      1391    61/95         64% 0.554420      84.3249
  5599    15      1401    71/95         75% 0.899555      83.9769
  5628    15      1411    81/95         85% 0.691303      83.6378
  5657    15      1421    91/95         96% 0.449141      83.7539

  Time Epoch Iteration Progress     Dev/Acc. Dev/Pr.  Dev/Recall   Dev/F1       Dev/Loss
  5774    15      1425    15/30     0.6394   0.6394   0.6394       0.6394       1.3427
Early Stopping. Epoch: 15, Best Dev F1: 0.6443235221370269
Evaluation metrics for dev
['accuracy', 'precision', 'recall', 'f1', 'cross_entropy_loss']
[0.6443235221370269, 0.6443235221370269, 0.6443235221370269, 0.6443235221370269, 1.2817093766387253]
Evaluation metrics for test
['accuracy', 'precision', 'recall', 'f1', 'cross_entropy_loss']
[0.6443235221370269, 0.6443235221370269, 0.6443235221370269, 0.6443235221370269, 1.2817093766387253]